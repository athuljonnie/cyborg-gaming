<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cyborg Gaming</title>
  
  <style>
    .body {
      background-color: #000000;
    }

    #navbar1 {
      background-color: #000000 !important;
      font-family: 'DotGothic16', sans-serif;
    }

    .navbar-brand {
      color: white;
      font-weight: 900;
    }

    .navbar-brand:hover {
      color: rgb(0, 0, 0);
    }

    .navbar-nav {
      margin-left: auto;
    }

    .nav-item {
      padding: 0 15px;
    }

    .navbar-toggler {
      border: none;
      outline: none;
    }

    .navbar-toggler-icon {
      background-color: rgb(173, 168, 168);
    }

    @media (max-width: 767px) {
      .navbar-collapse {
        justify-content: center;
      }
    }

    .c-item {
      height: 100%;
    }

    .c-img {
      height: 80vh;
      object-fit: cover;
    }

    .description-truncate {
      max-height: 5em;
      overflow-y: scroll;
    
      text-overflow: ellipsis;
      white-space: normal;
    }

    .description-truncate::-webkit-scrollbar{
      display: none
    }

    .description-container {
      max-height: 10em;
      overflow: auto;
    }


    .fa-heart {
      color: rgb(255, 255, 255);
      transition: color 0.3s;

    }
    .fa-shopping-cart {
      color: rgb(255, 253, 253);
      transition: color 0.3s;

    }

    .fa-heart:hover{
      color: #f44336;
    }
 

    .fa-shopping-cart:hover{
      color: #05d40f;
    }
 


    .cart-icon-link  {
      color: black;
      padding: 15px;
    }

    .cart-icon-link:hover {
      color: rgb(9, 9, 9);

    }

    .card-body {
      background-color: #c7c7c7;
    }

    #heading1 {
      background-image: url('/shop/img/8481.jpg');
      font-family: 'DotGothic16', sans-serif;
      background-color: #333;
      color: #000000;
      display: flex;

      height: 100vh;
      margin: 0;
      background-repeat: no-repeat;
      background-size: cover;
    }

    .search-input {
      color: #c7c7c7;
      background-color: #2c2c2c;
      width: 150px;
      height: 40px;
      padding: 10px;
      transition: 0.2s linear;
      border: 1px solid rgb(58, 58, 58);
      font-size: 14px;
      letter-spacing: 2px;
    }

    .search-input:focus {
      outline: none;
      border: 0.5px solid rgb(255, 234, 0);
      box-shadow: -5px -5px 0px black;
    }

    .input-container:hover>.icon {
      animation: anim 1s linear infinite;
    }

    @keyframes anim {

      0%,
      100% {
        transform: translateY(calc(-50% - 5px)) scale(1);
      }

      50% {
        transform: translateY(calc(-50% - 5px)) scale(1.1);
      }
    }

    
    .dropdown-toggle {
      color: #c7c7c7;

    }

  
    h3{
      color: #E6970D;
    }

    .footer{
      background-color: #2c2c2c;
    }

    #carouselExampleControls a{
      color: #000000;
    }

    #carouselExampleControls a:hover{
     color: #fffb04;
    }

    .toast-success {
      background-color: #4caf50;
    }


    .toast-error {
      background-color: #f44336;
    }


    .blur-image {
    filter: blur(4px); 
}

  </style>
</head>

<body class="bg-dark" id="hero">

 


  <div id="carouselExampleControls" class="carousel slide" data-ride="carousel"
    style="font-family: 'DotGothic16', sans-serif;">
    <ol class="carousel-indicators">
      <li data-target="#carouselExampleControls" data-slide-to="0" class="active"></li>
      <li data-target="#carouselExampleControls" data-slide-to="1"></li>
      <li data-target="#carouselExampleControls" data-slide-to="2"></li>
    </ol>
    <div class="carousel-inner">
      <div class="carousel-item active c-item">
        <img class="d-block w-100 c-img" src="/shop/img/pc.jpg" alt="First slide">
        <div class="carousel-caption top-0 mt-4 d-none d-md-block">
          <h1 class="mt-5">Streaming Machines</h1>
          <a href="/category/desktop-pcs?cat=64bf8f425b894e67f9366cf7"><p>Shop Now</p></a>
        </div>
      </div>
      <div class="carousel-item c-item">
        <img class="d-block w-100 c-img" src="/shop/img/carousel.jpeg" alt="Second slide">
        <div class="carousel-caption top-0 mt-4 d-none d-md-block">
          <h1 class="mt-5">Editing PowerHouses</h1>
          <a href="/category/desktop-pcs?cat=64bfebbe371a585154e96748"><p>Shop Now</p></a>
        </div>
      </div>
      <div class="carousel-item c-item">
        <img class="d-block w-100 c-img" src="/shop/img/PCs_By_Game_.jpg" alt="Third slide">
        <div class="carousel-caption top-0 mt-4 d-none d-md-block">
          <h1 class="mt-5">Game Zone</h1>
          <a href="/category/desktop-pcs?cat=64bf8eb95b894e67f9366cee"><p>Shop Now</p></a>
        </div>
      </div>
    </div>
    <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
      <span class="sr-only">Previous</span>
    </a>
    <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
      <span class="carousel-control-next-icon" aria-hidden="true"></span>
      <span class="sr-only">Next</span>
    </a>
  </div>


  <div id="heading"
    style="background-color: rgb(0, 0, 0); height: 90px; width: 100%;  align-items: center; justify-content: center; display: flex;">
    <h1
      style="font-weight: 500;margin-top: 0.5rem;font-family: 'VT323', monospace; letter-spacing: 3px;color:#E6970D;">
      Featured Products</h1>
  </div>



  <section style="background-color: rgb(26, 26, 26);">
    <div class="container py-5">
      <div class="row justify-content-center">
  

        <% if (!productData || productData.length===0 ) { %>
          <p>No products found.</p>
          <% } else { %>

            <% productData.forEach((product, index)=> { %>
              <% if (product.listed===true) { %>
                <% if (index % 3===0) { %>
      </div>
      <div class="row justify-content-center">
        <% } %>
          <div class="col-md-4 col-lg-4 col-xl-4 my-5">
            <img src="/uploads/<%= product.productImage[0] %>" alt="Product Image" class="card-img-top fixed-image <%= product.productQuantity === 0 ? 'blur-image' : '' %>">
            <div class="card text-black">
              <div class="card-body">
                <div class="text-center">
                  <h5 class="card-title">
                    <%= product.productName %>
                  </h5>
                  <container class="description" style=" overflow-y: scroll;">
                    <p class="text-muted mb-4 description-truncate">
                      <%= product.productDescription %>
                    </p>
                  </container>
                </div>
                <div>
                  <div class="d-flex justify-content-between">
                    <span>Price:</span>
                    <span>
                        <b>â‚¹</b>
                        <% if (product.catoffer && product.catofferPrice < product.productPrice) { %>
                            <strike><%= product.productPrice %></strike> <%= product.catofferPrice %>
                            (<%= product.catofferPercentage %> off)
                        <% } else if (product.offer && product.offerPrice < product.productPrice) { %>
                            <strike><%= product.productPrice %></strike> <%= product.offerPrice %>
                           <span style="color: #ff0000;"> (<%= product.offerPercentage %>% off)</span>
                        <% } else { %>
                            <%= product.productPrice %>
                        <% } %>
                    </span>
                </div>
                  <div class="d-flex justify-content-between">
                    <span></span><span></span>
                  </div>
                  <div class="d-flex justify-content-between">
                    <span>Category</span><span>
                      <%= product.category.CategoryName %>
                    </span>
                  </div>
                </div>
                <div class="d-flex justify-content-between total font-weight-bold mt-4">
                </div>
                <div class="d-flex justify-content-between total font-weight-bold mt-4">
                  <span class>
                    <% if (product.productQuantity > 0) { %>
                        <a href="" onclick="addToWishlist('<%=product._id%>')"><i class="fas fa-heart"></i></a>
                        <a href="" onclick="addToCart('<%= product._id %>')"><i class="fas fa-shopping-cart"></i></a>
                    <% } %>
                </span>
                <span></span>
                <span>
                    <% if (product.productQuantity > 0) { %>
                        <a href="productdetails?productId=<%= product._id %>">
                            <button type="button" class="btn btn-outline-dark shop-now-button">Shop Now</button>
                        </a>
                    <% } %>
                </span>
                </div>
              </div>
            </div>
          </div>
          <% } %>
            <% }); %>
              <% } %>
      </div>
    </div>
  </section>

  



  <script>

    function addToCart(productId) {
 
      $.ajax({
        url: `/cartload?productId=${productId}`,
        type: 'GET',
        success: function (response) {
          if (response.success) {         
            toastr.options = {
              closeButton: true,
              positionClass: "toast-bottom-right",
              timeOut: 3000,             
              toastClass: "toast-success"
            };
            toastr.success("Product added to cart!", "Success", {
              progressBar: true,
            });
          } else {           
            toastr.options = {
              closeButton: true,
              positionClass: "toast-bottom-right",
              timeOut: 3000,
              toastClass: "toast-error"
            };
            toastr.error("Failed to add product to cart. Please try logging in.", "Error", {
              progressBar: true,
            });
                     }
        },
        error: function (error) {
          toastr.options = {
            closeButton: true,
            positionClass: "toast-bottom-right",
            timeOut: 3000,
            toastClass: "toast-error"
          };
          toastr.error("Failed to add product to cart. Please try again.", "Error", {
            progressBar: true,
          });
        }
      });
    }
  </script>

  <script>

    function addToWishlist(productId) {
      $.ajax({
        url: `/wishlistload?productId=${productId}`,
        type: 'GET',
        success: function (response) {
          if (response.success) {
            toastr.options = {
              closeButton: true,
              positionClass: "toast-bottom-right",
              timeOut: 3000,
              toastClass: "toast-success"
            };
            toastr.success("Product added to Wishlist!", "Success", {
              progressBar: true,
            });
          } else {
            toastr.options = {
              closeButton: true,
              positionClass: "toast-bottom-right",
              timeOut: 3000,
              toastClass: "toast-error"
            };
            toastr.error(response.message, "Error", {
              progressBar: true,
            });
          }
        },
        error: function (error) {
          toastr.options = {
            closeButton: true,
            positionClass: "toast-bottom-right",
            timeOut: 3000,
            toastClass: "toast-error"
          };
          toastr.error("Failed to add product to Wishlist. Please try again.", "Error", {
            progressBar: true,
          });
        }
      });
    }
  </script>


<script>
  const searchForm = document.getElementById("search-form");
  const searchInput = document.getElementById("search-input");
  searchForm.addEventListener("submit", function (event) {
    
    event.preventDefault();
    const searchTerm = searchInput.value;
  $.ajax({
      type: 'GET',
      url: '/search',
      data: { searchTerm: searchTerm },
      success: function (response) {
          $('body').empty();
          $('body').html(response);
      },
      error: function (error) {
          console.error('Error sending data:', error);
      }
  })
  });
</script>


  <script>
    document.getElementById("search-form").addEventListener("submit", function (e) {
      var searchTerm = document.getElementById("search-input").value.trim(); 
      if (!searchTerm) {
        e.preventDefault(); 
      }
    });
  </script>
</body>

</html>